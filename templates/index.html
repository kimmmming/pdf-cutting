{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card shadow main-upload-card">
            <div class="card-header text-white">
                <div class="d-flex align-items-center">
                    <div class="upload-icon me-3">
                        <i class="fas fa-file-pdf"></i>
                    </div>
                    <div>
                        <h4 class="mb-1">智能PDF章节分割工具</h4>
                        <p class="mb-0 opacity-75">轻松将大型PDF文档按章节自动分割成多个小文件</p>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <!-- 拖拽上传提示区域 -->
                <div class="upload-zone mb-4" id="uploadZone">
                    <div class="text-center">
                        <i class="fas fa-cloud-upload-alt upload-zone-icon mb-3"></i>
                        <h5>拖拽PDF文件到此处，或点击下方按钮选择文件</h5>
                        <p class="text-muted">支持最大50MB的PDF文档</p>
                    </div>
                </div>
                
                <form id="uploadForm" enctype="multipart/form-data">
                    <div class="mb-4">
                        <label for="pdfFile" class="form-label">
                            <i class="fas fa-file-alt me-2"></i>选择PDF文件
                        </label>
                        <input type="file" class="form-control file-input" id="pdfFile" name="file" accept=".pdf" required>
                        <div class="form-text">
                            <i class="fas fa-info-circle me-1"></i>
                            仅支持PDF格式文件，文件大小不超过50MB，建议选择包含明确章节标题的文档
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label for="customPatterns" class="form-label">
                            <i class="fas fa-cogs me-2"></i>自定义章节识别模式 
                            <span class="badge bg-secondary ms-2">高级选项</span>
                        </label>
                        <textarea class="form-control" id="customPatterns" name="custom_patterns" rows="3" 
                                  placeholder="如需自定义章节识别规则，请输入正则表达式，每行一个：&#10;^附录.*&#10;^序言&#10;^目录&#10;^参考文献"></textarea>
                        <div class="form-text">
                            <i class="fas fa-lightbulb me-1"></i>
                            <strong>可选设置：</strong>如果系统自动识别的章节不够准确，您可以添加自定义的正则表达式来提高识别精度。大多数情况下保持空白即可。
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <div class="info-card">
                            <h6 class="info-title">
                                <i class="fas fa-magic me-2"></i>智能识别的章节格式
                            </h6>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="format-item">
                                        <i class="fas fa-check-circle text-success me-2"></i>
                                        <strong>中文格式：</strong><br>
                                        第一章、第1章、第1节
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="format-item">
                                        <i class="fas fa-check-circle text-success me-2"></i>
                                        <strong>英文格式：</strong><br>
                                        Chapter 1、Section 1
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="format-item">
                                        <i class="fas fa-check-circle text-success me-2"></i>
                                        <strong>数字格式：</strong><br>
                                        1. 标题、2. 标题
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <div class="feature-highlights">
                            <div class="row text-center">
                                <div class="col-6 col-md-3">
                                    <div class="feature-item">
                                        <i class="fas fa-brain feature-icon"></i>
                                        <small>智能识别</small>
                                    </div>
                                </div>
                                <div class="col-6 col-md-3">
                                    <div class="feature-item">
                                        <i class="fas fa-download feature-icon"></i>
                                        <small>批量下载</small>
                                    </div>
                                </div>
                                <div class="col-6 col-md-3">
                                    <div class="feature-item">
                                        <i class="fas fa-shield-alt feature-icon"></i>
                                        <small>安全可靠</small>
                                    </div>
                                </div>
                                <div class="col-6 col-md-3">
                                    <div class="feature-item">
                                        <i class="fas fa-rocket feature-icon"></i>
                                        <small>快速处理</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-lg w-100 submit-btn" id="uploadBtn">
                        <i class="fas fa-scissors me-2"></i>
                        <span class="btn-text">开始智能分割PDF</span>
                        <span class="btn-subtext">点击此按钮开始处理您的文档</span>
                    </button>
                </form>
                
                <!-- 进度条 -->
                <div id="progressSection" class="mt-4 progress-section" style="display: none;">
                    <div class="text-center mb-3">
                        <i class="fas fa-cog fa-spin processing-icon"></i>
                        <h6 class="mt-2">正在智能处理您的PDF文档</h6>
                    </div>
                    <div class="progress mb-3">
                        <div class="progress-bar progress-bar-striped progress-bar-animated" 
                             role="progressbar" style="width: 0%"></div>
                    </div>
                    <div id="progressText" class="text-center">
                        <i class="fas fa-info-circle me-1"></i>
                        正在分析文档结构...
                    </div>
                    <div class="progress-tips mt-3">
                        <small class="text-muted">
                            <i class="fas fa-lightbulb me-1"></i>
                            系统正在智能识别章节标题，大型文档可能需要稍长时间，请耐心等待
                        </small>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 结果展示区域 -->
        <div id="resultSection" class="card shadow mt-4 result-card" style="display: none;">
            <div class="card-header text-white result-header">
                <div class="d-flex align-items-center">
                    <div class="success-icon-wrapper me-3">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div>
                        <h4 class="mb-1">PDF分割成功完成！</h4>
                        <p class="mb-0 opacity-75">您的文档已成功分割为多个章节文件</p>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div class="result-summary mb-4">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-file-pdf text-danger me-2"></i>
                                <div>
                                    <strong>原始文件：</strong>
                                    <span id="originalFilename" class="filename-display"></span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 text-end">
                            <button class="btn btn-primary download-all-btn" id="downloadAllBtn">
                                <i class="fas fa-file-archive me-2"></i>
                                <span class="btn-content">
                                    <span class="btn-text">下载全部章节</span>
                                    <small class="btn-subtext">ZIP压缩包</small>
                                </span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="chapters-section">
                    <h6 class="chapters-title">
                        <i class="fas fa-list me-2"></i>分割结果 - 章节文件列表
                    </h6>
                    <p class="text-muted mb-3">
                        <i class="fas fa-info-circle me-1"></i>
                        点击下方章节名称可单独下载，或使用上方按钮下载全部文件
                    </p>
                    <div id="chapterList" class="chapters-container">
                        <!-- 章节列表将通过JavaScript动态填充 -->
                    </div>
                </div>
                
                <div class="action-buttons mt-4 text-center">
                    <button class="btn btn-outline-primary btn-lg" onclick="location.reload()">
                        <i class="fas fa-plus me-2"></i>
                        <span class="btn-content">
                            <span class="btn-text">处理新的PDF文件</span>
                            <small class="btn-subtext">重新开始分割任务</small>
                        </span>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 使用说明 -->
<div class="row mt-5">
    <div class="col-md-12">
        <div class="card help-card">
            <div class="card-header">
                <div class="d-flex align-items-center">
                    <i class="fas fa-question-circle help-icon me-3"></i>
                    <div>
                        <h5 class="mb-1">使用指南 & 功能说明</h5>
                        <p class="mb-0 text-muted">了解如何高效使用PDF章节分割工具</p>
                    </div>
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="help-section">
                            <h6 class="help-subtitle">
                                <i class="fas fa-star me-2 text-warning"></i>核心功能特性
                            </h6>
                            <ul class="feature-list">
                                <li>
                                    <i class="fas fa-brain me-2 text-primary"></i>
                                    <strong>AI智能识别：</strong>自动检测中英文章节标题
                                </li>
                                <li>
                                    <i class="fas fa-cogs me-2 text-info"></i>
                                    <strong>灵活配置：</strong>支持多种章节标题格式和自定义模式
                                </li>
                                <li>
                                    <i class="fas fa-download me-2 text-success"></i>
                                    <strong>便捷下载：</strong>支持单个文件或批量ZIP下载
                                </li>
                                <li>
                                    <i class="fas fa-shield-alt me-2 text-secondary"></i>
                                    <strong>安全可靠：</strong>本地处理，自动文件名清理
                                </li>
                                <li>
                                    <i class="fas fa-mobile-alt me-2 text-warning"></i>
                                    <strong>响应式设计：</strong>支持手机、平板、电脑全平台
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="help-section">
                            <h6 class="help-subtitle">
                                <i class="fas fa-list-ol me-2 text-success"></i>操作步骤指引
                            </h6>
                            <ol class="step-list">
                                <li>
                                    <strong>上传文件：</strong>
                                    <span class="text-muted">拖拽或点击选择PDF文档（最大50MB）</span>
                                </li>
                                <li>
                                    <strong>配置选项：</strong>
                                    <span class="text-muted">可选择添加自定义章节识别规则</span>
                                </li>
                                <li>
                                    <strong>开始处理：</strong>
                                    <span class="text-muted">点击"开始智能分割PDF"按钮</span>
                                </li>
                                <li>
                                    <strong>等待完成：</strong>
                                    <span class="text-muted">系统自动分析并分割文档章节</span>
                                </li>
                                <li>
                                    <strong>下载文件：</strong>
                                    <span class="text-muted">选择单独下载或批量下载所有章节</span>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <div class="col-12">
                        <div class="tips-section">
                            <h6 class="help-subtitle">
                                <i class="fas fa-lightbulb me-2 text-warning"></i>使用小贴士
                            </h6>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="tip-item">
                                        <i class="fas fa-check-circle text-success me-2"></i>
                                        <strong>最佳效果：</strong>选择包含明确章节标题的PDF文档
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="tip-item">
                                        <i class="fas fa-clock text-info me-2"></i>
                                        <strong>处理时间：</strong>文档越大处理时间越长，请耐心等待
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="tip-item">
                                        <i class="fas fa-archive text-secondary me-2"></i>
                                        <strong>文件管理：</strong>处理后的文件会自动清理，请及时下载
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}